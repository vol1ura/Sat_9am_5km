# frozen_string_literal: true

panel '–î–µ—Ç–∞–ª–∏ –∑–∞–±–µ–≥–∞' do
  attributes_table_for activity do
    row '–ó–∞–±–µ–≥', &:event_name
    row :date
    row(:description) { |a| sanitized_text a.description }
    row :published
    row('–ü—Ä–æ—Ç–æ–∫–æ–ª –Ω–∞ —Å–∞–π—Ç–µ') { |a| link_to activity_url(a), a } if activity.published
  end
end

panel '–ü—Ä–æ—Ç–æ–∫–æ–ª' do
  table_for activity.results.includes(athlete: :club).order(:position) do
    column :position
    column :athlete
    column('—Å–∞–π—Ç üå≥') { |r| athlete_external_link(r.athlete) }
    column(:total_time) { |r| human_result_time(r.total_time) }
    column(:gender) do |r|
      if (athlete = r.athlete)
        athlete.gender.presence || render(partial: 'gender_links', locals: { result: r, activity: activity })
      end
    end
    column(:club) { |r| r.athlete&.club&.name }
  end
end

panel '–í–æ–ª–æ–Ω—Ç—ë—Ä—ã' do
  table_for activity.volunteers_roster.includes(:athlete) do
    column :name
    column(:role) { |v| human_volunteer_role v.role }
  end
end

panel '–ü—Ä–∞–≤–∫–∏ –∑–∞–±–µ–≥–∞' do
  table_for activity.own_and_associated_audits.includes(:user, :auditable).reorder(created_at: :desc) do
    column :auditable
    column :audited_changes
    column :version
    column :user
    column :created_at
  end
end
